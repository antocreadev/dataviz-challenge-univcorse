name: ğŸ‰ Post Congrats on Successful Build ğŸ‰

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ” Checkout code
        uses: actions/checkout@v2

      - name: ğŸ“¦ Install dependencies
        run: npm install

      - name: ğŸš€ Build the project
        run: npm run build

      - name: ğŸŠ Send congratulatory GIF to Discord
        if: success()
        run: |
          echo "ğŸ“¬ Envoie des messages Ã  Discord..."

          COMMIT_MESSAGES=$(git log -1 --pretty=format:'%s')
          
          curl -X POST -H "Content-Type: application/json" \
          -d '{
                "content": "ğŸ™ğŸ“ˆâš¡ï¸ Bravo Frate ! J\'ai mit Ã  jour la branch **main** ! ğŸ‰âš¡ï¸ğŸ“ˆğŸ™\n\n**Derniers changements :**\n'"${COMMIT_MESSAGES}"'",
                "embeds": [
                  {
                    "title": "ğŸˆ C\'est la fÃªte ! ğŸˆ",
                    "description": "Voici un super GIF pour cÃ©lÃ©brer ! ğŸ¥³",
                    "image": {
                      "url": "https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif"
                    }
                  }
                ]
              }' \
          "${{ secrets.DISCORD_WEBHOOK_URL }}"
